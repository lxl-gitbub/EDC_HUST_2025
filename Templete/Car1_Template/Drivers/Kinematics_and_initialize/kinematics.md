# 运动学控制函数说明文档

## 1. Straight 函数

### 原型
```c
float Straight(float dis, float speed);
```

### 功能
控制小车以指定速度沿直线前进或后退指定距离，自动进行速度和方向的PID调节。

### 参数
- `dis`：目标距离，单位为米。正值表示前进，负值表示后退。
- `speed`：目标速度，单位为米/秒。建议不超过小车最大速度。

### 返回值
- 返回剩余距离（米），为正表示尚未到达目标，为负表示已超出目标。

### 使用说明
- 第一次调用或目标距离变化时会自动初始化PID和距离计数。
- 每次调用会根据当前编码器和陀螺仪反馈自动调整左右轮速度，实现直线行驶。
- 支持前进和后退，方向自动判断。
- 推荐在主循环中周期性调用，直到返回值接近0（如绝对值小于0.05米）即可认为到达目标。

### 典型用法
```c
float remain = Straight(1.0f, 0.2f); // 前进1米，速度0.2m/s
if (fabs(remain) < 0.05f) {
    // 到达目标，停止电机
    LMotorSet(BREAK, 0);
    RMotorSet(BREAK, 0);
}
```

---

## 2. TurnLeft / TurnRight 函数
**注意由于小车有较大的惯性，实测发现输入为74时，输出与90较为接近**
### 原型
```c
void TurnLeft(float angle);
void TurnRight(float angle);
```

### 功能
控制小车原地左转或右转指定角度，自动判断当前偏航角并停止。

### 参数
- `angle`：目标转动角度，单位为度。正值即可。

### 使用说明
- 调用后小车会原地转动（左转：左轮后退，右轮前进；右转相反），直到当前偏航角与目标角度差值小于3度自动停止。
- 角度判断基于陀螺仪`getYaw()`反馈，适合原地转向。
- 推荐在主循环或任务流程中直接调用，函数内部自动阻塞直到转向完成。

### 典型用法
```c
TurnLeft(90);  // 原地左转90度
TurnRight(45); // 原地右转45度
```

---

## 3. 相关依赖说明

- 依赖编码器反馈（如`cSpeed()`）和陀螺仪反馈（如`getYaw()`、`getWz()`）。
- 依赖电机控制接口`LMotorSet`和`RMotorSet`。
- 依赖PID相关结构体和函数（如`PID_Init`、`PID_Update`、`PID_Compute`）。

---

## 4. 注意事项

- `Straight`函数适合周期性调用，不能单次调用后等待结果。
- `TurnLeft`和`TurnRight`为阻塞式，调用期间主循环会停在该函数内。
- 速度和距离参数请根据实际小车性能合理设置，避免过大导致控制失效。
- 角度判断有3度误差范围，实际转向精度受陀螺仪影响。